# 剖面導向程式設計

所提供的所謂的「剖面導向程式設計（AOP，Aspect-Oriented Programming）」主要是為了解決在實作橫切關切點機制、以及其他設計模式時，會出現的程式碼重複編碼問題。為此，在AOP中會先在單一定點實作這份設計模式後，再以不需要修改其他既有程式碼的方式，將這份模式套用到 code base 中其他需要的地方、或是乾脆集中於此點處理。

常見實作AOP的方式有以下幾種

| 方法    | 說明                                                                                             | 優點                                                                          | 缺點                                                                                                                                |
| ----- | ---------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------- |
| SOLID | 將剖面透過以抽象介面為中心的裝飾元件，套用在一群類別上                                                                    | <ul><li>不需要工作輔助</li><li>易於實作</li><li>可讓心力專注於設計層面</li><li>系統更具可維護性</li></ul> | 不一定能適用於傳統架構                                                                                                                       |
| 動態攔截  | 根據應用程式內部的抽象介面，於**執行階段**自動產生裝飾元件。這類裝飾元件會透過工具所提供的剖切面注入進去，又稱之為「攔截器」                               | 假設應用程式架構已是以介面為中心的前提下，只要稍作修改便能輕易套用在既有或傳統架構的應用程式上                             | <ul><li>對剖面的實作會與使用的AOP工具無法分割</li><li>無法獲得編譯期階段的各項好處</li><li>容易造成不確定的行爲與錯誤發生</li></ul>                                             |
| 後編譯織入 | 在後期編譯階段流程中將剖面加入到應用程式中。這通常是以IL(通用中繼程式語言)連結的形式實現，透過一個外部工具讀取已編譯過的檔案，在其中修改並加上剖面的實作，把原本的內容替換為修改過的內容 | 就算應用程式並非以介面為中心的架構，也只需要非常少量的修改就能輕易套用在既有或傳統架構的應用程式上                           | <ul><li>如果把不穩定依賴對象注入到剖面中，將有可能造成時序耦合或是測試耦合的問題</li><li>由於是在後編譯期階將剖面寫入進去，因此不可再呼叫到沒有被套用到剖面的程式碼版本。</li><li>後期編譯期階段的連結其實與DI架構</li></ul> |
|       |                                                                                                |                                                                             |                                                                                                                                   |
|       |                                                                                                |                                                                             |                                                                                                                                   |
|       |                                                                                                |                                                                             |                                                                                                                                   |
|       |                                                                                                |                                                                             |                                                                                                                                   |
|       |                                                                                                |                                                                             |                                                                                                                                   |
|       |                                                                                                |                                                                             |                                                                                                                                   |

